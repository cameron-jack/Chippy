<?xml version="1.0" ?>
<tool id="plot_centred_counts" name="plot centred counts" version="0.1">
	<description>
		Plots read counts around gene features
	</description>
	<requirements>
		<requirement type="package">
			qiime
		</requirement>
	</requirements>
	<command>
		plot_centred_counts.py --db_path=$db_path -c $collection --plot_filename=$plot_filename -m $metric
#if str($chrom) != 'None':
 -C $chrom
#end if

#if str($group_size):
 -g $group_size
#end if

#if str($group_location) != 'None':
 --group_location=$group_location
#end if

#if $top_features:
 --top_features
#end if

#if $smoothing:
 --smoothing=$smoothing
#end if

#if $binning:
 --binning=$binning
#end if

#if $cutoff:
 -k $cutoff
#end if

#if str($include_target) != 'None':
 --include_target=$include_target
#end if

#if str($exclude_target) != 'None':
 --exclude_target=$exclude_target
#end if

#if str($ylim):
 -y $ylim
#end if

#if $fig_height:
 -H $fig_height
#end if

#if $fig_width:
 -W $fig_width
#end if

#if $xgrid_lines:
 --xgrid_lines=$xgrid_lines
#end if

#if $ygrid_lines:
 --ygrid_lines=$ygrid_lines
#end if

#if $grid_off:
 --grid_off
#end if

#if $xtick_interval:
 --xtick_interval=$xtick_interval
#end if

#if $ytick_interval:
 --ytick_interval=$ytick_interval
#end if

#if $clean_plot:
 --clean_plot
#end if

#if str($bgcolor) != 'None':
 -b $bgcolor
#end if

#if $colorbar:
 --colorbar
#end if

#if str($title):
 --title=$title
#end if

#if str($ylabel):
 --ylabel=$ylabel
#end if

#if str($xlabel):
 --xlabel=$xlabel
#end if

#if $xfont_size:
 --xfont_size=$xfont_size
#end if

#if $yfont_size:
 --yfont_size=$yfont_size
#end if

#if $legend:
 -l
#end if

#if $legend_font_size:
 --legend_font_size=$legend_font_size
#end if

#if str($vline_style) != 'None':
 --vline_style=$vline_style
#end if

#if $vline_width:
 --vline_width=$vline_width
#end if

#if $line_alpha:
 --line_alpha=$line_alpha
#end if

#if $grey_scale:
 --grey_scale
#end if

#if $plot_series:
 --plot_series
#end if

#if str($text_coords):
 --text_coords=$text_coords
#end if

#if str($div):
 --div=$div
#end if

#if $confidence_intervals:
 --confidence_intervals
#end if

#if $normalise_by_RPM:
 --normalise_by_RPM
#end if

#if $test_run:
 -t
#end if

	</command>
	<inputs>
		<param label="--db_path: Path to ChippyDB" name="db_path" optional="False" type="data"/>
		<param label="-c/--collection: Path to the plottable data" name="collection" optional="False" type="text"/>
		<param label="--plot_filename: Name of final plot file" name="plot_filename" optional="False" type="text"/>
		<param label="-m/--metric: Select the metric (note you will need to change your ylim accordingly if providing via --ylim)" name="metric" optional="False" type="select">
			<option value="Mean counts">
				Mean counts
			</option>
			<option value="Frequency counts">
				Frequency counts
			</option>
			<option value="Standard deviation">
				Standard deviation
			</option>
		</param>
		<param label="-C/--chrom: Choose a chromosome" name="chrom" optional="True" type="select">
			<option selected="True" value="None">
				Selection is Optional
			</option>
		</param>
		<param default="All" label="-g/--group_size: Number of genes to group to estimate statistic - All or a specific number" name="group_size" optional="True" type="text"/>
		<param label="--group_location: The representative group in a study to form a plot line" name="group_location" optional="True" type="select">
			<option selected="True" value="None">
				Selection is Optional
			</option>
			<option value="all">
				all
			</option>
			<option value="top">
				top
			</option>
			<option value="middle">
				middle
			</option>
			<option value="bottom">
				bottom
			</option>
		</param>
		<param label="--top_features: Plot only top features ranked by expressed chromatin" name="top_features" selected="False" type="boolean"/>
		<param default="0" label="--smoothing: Window size for smoothing of plot data" name="smoothing" optional="True" type="integer"/>
		<param default="0" label="--binning: Sum counts within integer-sized bins across plot" name="binning" optional="True" type="integer"/>
		<param default="0.05" label="-k/--cutoff: Probability cutoff. Exclude genes if the probability of the observed tag count is less than or equal to this value e.g. 0.05." name="cutoff" optional="True" type="float"/>
		<param label="--include_target: A Target Gene List in ChipPyDB" name="include_target" optional="True" type="select">
			<option selected="True" value="None">
				Selection is Optional
			</option>
			<option value="None">
				None
			</option>
			<option value="none">
				none
			</option>
		</param>
		<param label="--exclude_target: A Target Gene List in ChipPyDB" name="exclude_target" optional="True" type="select">
			<option selected="True" value="None">
				Selection is Optional
			</option>
			<option value="None">
				None
			</option>
			<option value="none">
				none
			</option>
		</param>
		<param default="None" label="-y/--ylim: comma separated minimum-maximum yaxis values (e.g. 0,3.5)" name="ylim" optional="True" type="text"/>
		<param default="15.0" label="-H/--fig_height: Figure height (cm)" name="fig_height" optional="True" type="float"/>
		<param default="25.0" label="-W/--fig_width: Figure width (cm)" name="fig_width" optional="True" type="float"/>
		<param default="100" label="--xgrid_lines: major grid-line spacing on x-axis" name="xgrid_lines" optional="True" type="float"/>
		<param default="None" label="--ygrid_lines: major grid-line spacing on y-axis" name="ygrid_lines" optional="True" type="float"/>
		<param label="--grid_off: Turn grid lines off" name="grid_off" selected="False" type="boolean"/>
		<param default="2" label="--xtick_interval: number of blank ticks between labels" name="xtick_interval" optional="True" type="integer"/>
		<param default="2" label="--ytick_interval: number of blank ticks between labels" name="ytick_interval" optional="True" type="integer"/>
		<param label="--clean_plot: Remove tick marks and top and right borders " name="clean_plot" selected="False" type="boolean"/>
		<param label="-b/--bgcolor: Plot background color" name="bgcolor" optional="True" type="select">
			<option selected="True" value="None">
				Selection is Optional
			</option>
			<option value="black">
				black
			</option>
			<option value="white">
				white
			</option>
		</param>
		<param label="--colorbar: Add colorbar to figure" name="colorbar" selected="False" type="boolean"/>
		<param label="--title: Plot title" name="title" optional="True" type="text"/>
		<param default="Normalized counts" label="--ylabel: Label for the y-axis" name="ylabel" optional="True" type="text"/>
		<param default="Position relative to TSS" label="--xlabel: Label for the x-axis" name="xlabel" optional="True" type="text"/>
		<param default="12" label="--xfont_size: font size for x label" name="xfont_size" optional="True" type="integer"/>
		<param default="12" label="--yfont_size: font size for y label" name="yfont_size" optional="True" type="integer"/>
		<param label="-l/--legend: Automatically generate a figure legend." name="legend" selected="False" type="boolean"/>
		<param default="12" label="--legend_font_size: Point size for legend characters" name="legend_font_size" optional="True" type="integer"/>
		<param label="--vline_style: line style for centred vertical line" name="vline_style" optional="True" type="select">
			<option selected="True" value="None">
				Selection is Optional
			</option>
			<option value="-.">
				-.
			</option>
			<option value="-">
				-
			</option>
			<option value=".">
				.
			</option>
		</param>
		<param default="2" label="--vline_width: line width for centred vertical line" name="vline_width" optional="True" type="integer"/>
		<param default="1.0" label="--line_alpha: Opacity of lines" name="line_alpha" optional="True" type="float"/>
		<param label="--grey_scale: Plot colour range as grey-scale" name="grey_scale" selected="False" type="boolean"/>
		<param label="--plot_series: Plot series of figures. A directory called plot_filename-series will be created." name="plot_series" selected="False" type="boolean"/>
		<param default="None" label="--text_coords: x, y coordinates of series text (e.g. 600,3.0)" name="text_coords" optional="True" type="text"/>
		<param label="--div: Path to the plottable data, to divide other loaded plottable data" name="div" optional="True" type="text"/>
		<param label="--confidence_intervals: Show confidence intervals around plot lines" name="confidence_intervals" selected="False" type="boolean"/>
		<param label="--normalise_by_RPM: Normalise by Reads Per mapped-Million" name="normalise_by_RPM" selected="False" type="boolean"/>
		<param label="-t/--test_run: Test run, don't write output" name="test_run" selected="False" type="boolean"/>
	</inputs>
	<outputs/>
	<help>
		Takes read counts that are centred on on a gene feature such as TSS or intron-exon boundary, sorted from high to low gene expression and makes a heat-mapped line plot.
Generates either a single pdf figure or a series of pdfs that can be merged into a movie.
	</help>
</tool>
